---
title: "Training Large Language Models"
section: 5
duration: "4 minutes"
objectives:
  - "Understand how LLMs learn from text"
  - "Learn about pre-training vs fine-tuning"
  - "See the massive scale of training"
---

import { SectionHeader } from '@/components/slides/section-header'
import { DemoLink, Callout, TwoColumn, Figure } from '@/components/slides/demo-link'

<SectionHeader 
  title="Training LLMs"
  subtitle="Teaching Computers to Predict Text"
  gradient="from-orange-400 via-red-500 to-pink-600"
/>

---

## The Core Task: Next Word Prediction

<TwoColumn 
  left={
    <div className="space-y-6">
      <h3 className="text-xl font-bold">It's Simpler Than You Think</h3>
      
      <div className="space-y-4">
        <div className="glass-card p-4">
          <h4 className="font-semibold mb-2">Training Example #1</h4>
          <p className="text-sm">
            Input: <span className="font-mono bg-muted px-1 rounded">"The cat sat on the"</span><br/>
            Target: <span className="font-mono bg-primary/20 px-1 rounded text-primary">"mat"</span>
          </p>
        </div>
        
        <div className="glass-card p-4">
          <h4 className="font-semibold mb-2">Training Example #2</h4>
          <p className="text-sm">
            Input: <span className="font-mono bg-muted px-1 rounded">"Paris is the capital of"</span><br/>
            Target: <span className="font-mono bg-primary/20 px-1 rounded text-primary">"France"</span>
          </p>
        </div>
        
        <div className="glass-card p-4">
          <h4 className="font-semibold mb-2">Training Example #3</h4>
          <p className="text-sm">
            Input: <span className="font-mono bg-muted px-1 rounded">"To solve this equation, we need to"</span><br/>
            Target: <span className="font-mono bg-primary/20 px-1 rounded text-primary">"isolate"</span>
          </p>
        </div>
      </div>
      
      <Callout type="info" title="The Magic">
        By predicting the next word **billions** of times across **trillions** of examples, the model learns grammar, facts, reasoning, and even creativity!
      </Callout>
    </div>
  }
  right={
    <div className="mt-8 space-y-4">
      <div className="glass-card p-6">
        <h4 className="font-bold mb-4 text-center">How Prediction Works</h4>
        
        <div className="space-y-3">
          <div className="bg-muted/30 p-3 rounded">
            <div className="text-sm font-mono mb-2">Input: "The weather is"</div>
            <div className="space-y-1">
              <div className="flex justify-between items-center text-xs">
                <span>"sunny" </span>
                <div className="flex items-center gap-2">
                  <div className="w-16 bg-muted rounded-full h-2">
                    <div className="h-2 bg-green-500 rounded-full" style={{width: '45%'}}></div>
                  </div>
                  <span>45%</span>
                </div>
              </div>
              <div className="flex justify-between items-center text-xs">
                <span>"cloudy"</span>
                <div className="flex items-center gap-2">
                  <div className="w-16 bg-muted rounded-full h-2">
                    <div className="h-2 bg-blue-500 rounded-full" style={{width: '30%'}}></div>
                  </div>
                  <span>30%</span>
                </div>
              </div>
              <div className="flex justify-between items-center text-xs">
                <span>"rainy" </span>
                <div className="flex items-center gap-2">
                  <div className="w-16 bg-muted rounded-full h-2">
                    <div className="h-2 bg-purple-500 rounded-full" style={{width: '20%'}}></div>
                  </div>
                  <span>20%</span>
                </div>
              </div>
              <div className="flex justify-between items-center text-xs">
                <span>"other" </span>
                <div className="flex items-center gap-2">
                  <div className="w-16 bg-muted rounded-full h-2">
                    <div className="h-2 bg-gray-500 rounded-full" style={{width: '5%'}}></div>
                  </div>
                  <span>5%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div className="text-center text-sm text-muted-foreground">
        The model learns to predict probability distributions over all possible next words
      </div>
    </div>
  }
/>

---

## The Training Process

<div className="space-y-8">
  <h3 className="text-2xl font-bold text-center">Three Stages of Learning</h3>
  
  <div className="space-y-6">
    <div className="glass-card p-6 border-l-4 border-l-blue-500">
      <div className="flex items-start gap-4">
        <div className="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center flex-shrink-0">
          <span className="text-xl">üìö</span>
        </div>
        <div className="flex-1">
          <h4 className="text-lg font-bold text-blue-700 dark:text-blue-400 mb-2">1. Pre-training</h4>
          <p className="text-sm text-muted-foreground mb-3">
            Learn general language understanding from massive text corpora
          </p>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h5 className="font-semibold text-sm mb-1">Data Sources:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Web pages (Common Crawl)</li>
                <li>‚Ä¢ Books and literature</li>
                <li>‚Ä¢ Wikipedia articles</li>
                <li>‚Ä¢ News articles</li>
                <li>‚Ä¢ Academic papers</li>
              </ul>
            </div>
            <div>
              <h5 className="font-semibold text-sm mb-1">What It Learns:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Grammar and syntax</li>
                <li>‚Ä¢ World knowledge</li>
                <li>‚Ä¢ Common sense reasoning</li>
                <li>‚Ä¢ Multiple languages</li>
                <li>‚Ä¢ Writing styles</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div className="glass-card p-6 border-l-4 border-l-green-500">
      <div className="flex items-start gap-4">
        <div className="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0">
          <span className="text-xl">üéØ</span>
        </div>
        <div className="flex-1">
          <h4 className="text-lg font-bold text-green-700 dark:text-green-400 mb-2">2. Supervised Fine-tuning</h4>
          <p className="text-sm text-muted-foreground mb-3">
            Learn to follow instructions and have conversations
          </p>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h5 className="font-semibold text-sm mb-1">Training Data:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Human-written conversations</li>
                <li>‚Ä¢ Instruction-following examples</li>
                <li>‚Ä¢ Question-answer pairs</li>
                <li>‚Ä¢ Task-specific demonstrations</li>
              </ul>
            </div>
            <div>
              <h5 className="font-semibold text-sm mb-1">Improvements:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Better instruction following</li>
                <li>‚Ä¢ More helpful responses</li>
                <li>‚Ä¢ Reduced harmful outputs</li>
                <li>‚Ä¢ Task-specific performance</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div className="glass-card p-6 border-l-4 border-l-purple-500">
      <div className="flex items-start gap-4">
        <div className="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center flex-shrink-0">
          <span className="text-xl">üë•</span>
        </div>
        <div className="flex-1">
          <h4 className="text-lg font-bold text-purple-700 dark:text-purple-400 mb-2">3. Human Preference Learning</h4>
          <p className="text-sm text-muted-foreground mb-3">
            Align with human values and preferences (RLHF)
          </p>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h5 className="font-semibold text-sm mb-1">Process:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Humans rank model outputs</li>
                <li>‚Ä¢ Train reward model</li>
                <li>‚Ä¢ Use reinforcement learning</li>
                <li>‚Ä¢ Iterative improvement</li>
              </ul>
            </div>
            <div>
              <h5 className="font-semibold text-sm mb-1">Goals:</h5>
              <ul className="text-xs space-y-1 text-muted-foreground">
                <li>‚Ä¢ Helpful responses</li>
                <li>‚Ä¢ Honest and truthful</li>
                <li>‚Ä¢ Harmless behavior</li>
                <li>‚Ä¢ User satisfaction</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

---

## The Scale Is Mind-Boggling

<div className="space-y-8">
  <h3 className="text-2xl font-bold text-center">Training Numbers That Break Your Brain</h3>
  
  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
    <div className="glass-card p-4 text-center">
      <div className="text-2xl font-bold text-primary mb-2">300B+</div>
      <div className="text-sm text-muted-foreground">Tokens seen during training</div>
      <div className="text-xs text-muted-foreground mt-1">‚âà 75 million novels</div>
    </div>
    
    <div className="glass-card p-4 text-center">
      <div className="text-2xl font-bold text-primary mb-2">$4.6M</div>
      <div className="text-sm text-muted-foreground">GPT-3 training cost</div>
      <div className="text-xs text-muted-foreground mt-1">Just the compute!</div>
    </div>
    
    <div className="glass-card p-4 text-center">
      <div className="text-2xl font-bold text-primary mb-2">34 days</div>
      <div className="text-sm text-muted-foreground">Training duration</div>
      <div className="text-xs text-muted-foreground mt-1">On 1,024 GPUs</div>
    </div>
    
    <div className="glass-card p-4 text-center">
      <div className="text-2xl font-bold text-primary mb-2">285 MWh</div>
      <div className="text-sm text-muted-foreground">Energy consumed</div>
      <div className="text-xs text-muted-foreground mt-1">‚âà 126 homes for 1 year</div>
    </div>
  </div>
  
  <Callout type="warning" title="Environmental Impact">
    Training large models requires enormous energy. The AI industry is working on more efficient training methods and using renewable energy sources.
  </Callout>
</div>

---

## What Happens During Training

<div className="space-y-6">
  <h3 className="text-xl font-bold text-center">The Learning Curve</h3>
  
  <div className="glass-card p-6">
    <div className="space-y-6">
      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <h4 className="font-bold mb-4">Early Training (Days 1-5)</h4>
          <div className="space-y-3">
            <div className="flex items-center gap-3">
              <div className="w-4 h-4 bg-red-400 rounded-full"></div>
              <span className="text-sm">Learning basic patterns</span>
            </div>
            <div className="bg-muted/30 p-3 rounded font-mono text-sm">
              <div>Input: "The cat"</div>
              <div className="text-red-500">Output: "xkj9 mzw !!!"</div>
              <div className="text-xs text-muted-foreground mt-1">Completely random</div>
            </div>
          </div>
        </div>
        
        <div>
          <h4 className="font-bold mb-4">Mid Training (Days 10-20)</h4>
          <div className="space-y-3">
            <div className="flex items-center gap-3">
              <div className="w-4 h-4 bg-orange-400 rounded-full"></div>
              <span className="text-sm">Grammar and structure</span>
            </div>
            <div className="bg-muted/30 p-3 rounded font-mono text-sm">
              <div>Input: "The cat"</div>
              <div className="text-orange-500">Output: "is running very fast"</div>
              <div className="text-xs text-muted-foreground mt-1">Grammatical but basic</div>
            </div>
          </div>
        </div>
        
        <div>
          <h4 className="font-bold mb-4">Late Training (Days 25-30)</h4>
          <div className="space-y-3">
            <div className="flex items-center gap-3">
              <div className="w-4 h-4 bg-yellow-400 rounded-full"></div>
              <span className="text-sm">World knowledge</span>
            </div>
            <div className="bg-muted/30 p-3 rounded font-mono text-sm">
              <div>Input: "The cat"</div>
              <div className="text-yellow-600">Output: "sat peacefully on the warm windowsill"</div>
              <div className="text-xs text-muted-foreground mt-1">Coherent and contextual</div>
            </div>
          </div>
        </div>
        
        <div>
          <h4 className="font-bold mb-4">Final Training (Days 30+)</h4>
          <div className="space-y-3">
            <div className="flex items-center gap-3">
              <div className="w-4 h-4 bg-green-400 rounded-full"></div>
              <span className="text-sm">Reasoning and creativity</span>
            </div>
            <div className="bg-muted/30 p-3 rounded font-mono text-sm">
              <div>Input: "The cat"</div>
              <div className="text-green-600">Output: "studied quantum mechanics with surprising dedication"</div>
              <div className="text-xs text-muted-foreground mt-1">Creative and unexpected</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

---

## Emergent Abilities

<div className="space-y-6">
  <h3 className="text-xl font-bold text-center">Surprising Capabilities That Just... Appear</h3>
  
  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div className="glass-card p-6 space-y-4">
      <h4 className="font-bold">üßÆ Mathematical Reasoning</h4>
      <p className="text-sm text-muted-foreground">
        Not explicitly trained on math, but learns to solve complex problems by seeing examples
      </p>
      <div className="bg-muted/30 p-3 rounded text-sm font-mono">
        "If 3x + 7 = 22, what is x?"<br/>
        <span className="text-primary">"x = 5, because 3(5) + 7 = 22"</span>
      </div>
    </div>
    
    <div className="glass-card p-6 space-y-4">
      <h4 className="font-bold">üíª Code Generation</h4>
      <p className="text-sm text-muted-foreground">
        Learns programming patterns from GitHub and Stack Overflow examples
      </p>
      <div className="bg-muted/30 p-3 rounded text-sm font-mono">
        "Write a function to sort a list"<br/>
        <span className="text-primary">"def sort_list(lst): return sorted(lst)"</span>
      </div>
    </div>
    
    <div className="glass-card p-6 space-y-4">
      <h4 className="font-bold">üåç Language Translation</h4>
      <p className="text-sm text-muted-foreground">
        Becomes multilingual without explicit translation training
      </p>
      <div className="bg-muted/30 p-3 rounded text-sm font-mono">
        "Hello world" ‚Üí <span className="text-primary">"Hola mundo"</span>
      </div>
    </div>
    
    <div className="glass-card p-6 space-y-4">
      <h4 className="font-bold">üé≠ Creative Writing</h4>
      <p className="text-sm text-muted-foreground">
        Develops artistic abilities by learning from literature and poetry
      </p>
      <div className="bg-muted/30 p-3 rounded text-sm font-mono">
        "Write a haiku about AI"<br/>
        <span className="text-primary">"Silicon dreams wake,<br/>Patterns dance in neural nets,<br/>Minds born from our code"</span>
      </div>
    </div>
  </div>
  
  <Callout type="tip" title="The Mystery">
    We still don't fully understand **why** these abilities emerge. It seems like at sufficient scale, language models develop general intelligence capabilities!
  </Callout>
</div>

---

## Explore Model Training

<div className="space-y-4">
  <h3 className="text-xl font-bold text-center">Learn More About Training</h3>
  
  <div className="grid gap-4">
    <DemoLink
      href="https://karpathy.ai/zero-to-hero.html"
      title="Andrej Karpathy's Neural Networks Course"
      description="Build GPT from scratch in Python"
      preview="Step-by-step video series on implementing and training transformers"
      variant="large"
    />
    
    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
      <DemoLink
        href="https://huggingface.co/docs/transformers/training"
        title="Hugging Face Training Guide"
        description="Practical guide to fine-tuning models"
        preview="Learn to train your own models on custom datasets"
      />
      
      <DemoLink
        href="https://openai.com/research/training-language-models-to-follow-instructions-with-human-feedback"
        title="RLHF Paper"
        description="How ChatGPT was trained"
        preview="The research behind training helpful, harmless AI assistants"
      />
    </div>
  </div>
</div>

---

<Callout type="success" title="Training: The Foundation of Intelligence">
  Through massive-scale next-word prediction, language models develop emergent capabilities including reasoning, coding, creativity, and multilingual understanding. The training process is expensive but creates incredibly capable systems!
</Callout>